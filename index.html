<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Fin ZD demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="p-6 min-h-screen flex items-center justify-center">
    <button class="bg-black text-white p-2 rounded" id="reset">Reset</button>

    <script>
      document.getElementById('reset').onclick = function reset() {
        document.cookie.split(";").forEach(c => {
          const [n] = c.split("=");
          document.cookie = n + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
        });
        localStorage.clear(); sessionStorage.clear(); location.reload();
      };

      async function boot() {
        // In prod, pull uid/email from your session, not query params.
        const params = new URLSearchParams(location.search);
        const uid = params.get('uid') || '5068687910815';
        const email = params.get('email') || 'jd@zendeskdemo.com';

        const res = await fetch(`/api/jwt.php?uid=${encodeURIComponent(uid)}&email=${encodeURIComponent(email)}`, {
          credentials: 'same-origin'
        });
        const { token } = await res.json();

        window.intercomSettings = {
          api_base: "https://api-iam.intercom.io",
          app_id: "z1n0atmw",
          user_id: uid,
          email,
          jwt: token
        };

        (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{
          var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;
          var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/z1n0atmw';
            var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};
          if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}
        }})();
      }
      boot();
    </script>

    <script id="ze-snippet" src="https://static.zdassets.com/ekr/snippet.js?key=64e085db-b7a2-4e29-911a-1987b55892bf"></script>
  </body>
</html>
